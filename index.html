<!DOCTYPE html>
<html lang="mn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mandri Hub | –ú—ç–¥—ç—ç–ª–ª–∏–π–Ω –Ω—ç–≥–¥—Å—ç–Ω —Ç”©–≤</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div class="nav-container">
            <div class="logo" onclick="location.reload()">Mandri<span>Hub</span></div>
            <nav>
                <a href="submit.html" class="btn-submit">+ –ù–∏–π—Ç–ª—ç–ª –æ—Ä—É—É–ª–∞—Ö</a>
            </nav>
        </div>
    </header>

    <div class="container">
        <div id="home-scene" class="scene active">
            <h1 class="center-title">–°—ç–¥—ç–≤ —Å–æ–Ω–≥–æ–Ω–æ —É—É</h1>
            <div class="scene-grid">
                <div class="scene-card news" onclick="loadPosts('news')">
                    <div class="icon">üì∞</div>
                    <h3>–ú—ç–¥—ç—ç–ª—ç–ª</h3>
                </div>
                <div class="scene-card recipe" onclick="loadPosts('recipe')">
                    <div class="icon">üçï</div>
                    <h3>–•–æ–æ–ª–Ω—ã –ñ–æ—Ä</h3>
                </div>
                <div class="scene-card history" onclick="loadPosts('history')">
                    <div class="icon">üìú</div>
                    <h3>–¢“Ø“Ø—Ö—ç–Ω —Å—ç–¥—ç–≤</h3>
                </div>
            </div>
        </div>

        <div id="list-scene" class="scene">
            <button class="back-btn" onclick="showScene('home-scene')">‚Üê –ë—É—Ü–∞—Ö</button>
            <h1 id="category-display-title">–°—ç–¥—ç–≤</h1>
            <div id="posts-container" class="post-list">
                </div>
        </div>
    </div>

    <script>
        const scriptURL = "https://script.google.com/macros/s/AKfycbyjWKG3JGL0Lxqm6jCuqUI2Du6SESUKLvXMamjRZ023xh-9iBH-5TWQKROMVlJau9Jp2Q/exec";

        function showScene(id) {
            document.querySelectorAll('.scene').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            window.scrollTo(0,0);
        }

        async function loadPosts(category) {
            showScene('list-scene');
            const titleMap = {'news': 'üì∞ –ú—ç–¥—ç—ç –º—ç–¥—ç—ç–ª—ç–ª', 'recipe': 'üçï –•–æ–æ–ª–Ω—ã –ñ–æ—Ä', 'history': 'üìú –¢“Ø“Ø—Ö—ç–Ω —Å—ç–¥—ç–≤'};
            document.getElementById('category-display-title').innerText = titleMap[category];
            
            const container = document.getElementById('posts-container');
            container.innerHTML = "<p class='loading-text'>–ú—ç–¥—ç—ç–ª–ª–∏–π–≥ —Ç–∞—Ç–∞–∂ –±–∞–π–Ω–∞...</p>";

            try {
                const response = await fetch(scriptURL);
                const data = await response.json();
                container.innerHTML = "";

                // –°—ç–¥—ç–≤ –±–æ–ª–æ–Ω —Ö–æ–æ—Å–æ–Ω –±–∏—à ”©–≥”©–≥–¥–ª”©”©—Ä —à“Ø“Ø–Ω—ç
                const filtered = data.filter(row => row[0] === category && row[1]).reverse();

                if (filtered.length === 0) {
                    container.innerHTML = "<div class='empty-msg'>–≠–Ω—ç —Å—ç–¥—ç–≤—Ç –æ–¥–æ–æ–≥–æ–æ—Ä –Ω–∏–π—Ç–ª—ç–ª –∞–ª–≥–∞.</div>";
                    return;
                }

                filtered.forEach(row => {
                    container.innerHTML += `
                        <div class="post-card">
                            <div class="post-body">
                                <p class="post-text">${row[1]}</p>
                                ${row[2] ? `<img src="${row[2]}" class="post-media" onerror="this.style.display='none'">` : ""}
                            </div>
                            <div class="post-footer">–®—É—É–¥ –Ω–∏–π—Ç–ª—ç–≥–¥—Å—ç–Ω</div>
                        </div>`;
                });
            } catch (e) {
                container.innerHTML = "<p>–ê–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞. –¢“Ø—Ä —Ö“Ø–ª—ç—ç–≥—ç—ç–¥ –¥–∞—Ö–∏–Ω –æ—Ä–æ–ª–¥–æ–Ω–æ —É—É.</p>";
            }
        }
    </script>
</body>
</html>