<!DOCTYPE html>
<html lang="mn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mandri Hub | –®—É—É–¥ –ù–∏–π—Ç–ª—ç–ª</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div class="nav-container">
            <div class="logo" onclick="location.reload()">Mandri<span>Hub</span></div>
            <nav><a href="submit.html" class="btn-submit">+ –ù–∏–π—Ç–ª—ç–ª –Ω—ç–º—ç—Ö</a></nav>
        </div>
    </header>

    <div class="container">
        <div id="home-scene" class="scene active">
            <h1 class="center-title">–°—ç–¥—ç–≤ —Å–æ–Ω–≥–æ–æ–¥ –Ω–∏–π—Ç–ª—ç–ª“Ø“Ø–¥–∏–π–≥ “Ø–∑</h1>
            <div class="scene-grid">
                <div class="scene-card" onclick="loadPosts('news')">üì∞ –ú—ç–¥—ç—ç</div>
                <div class="scene-card" onclick="loadPosts('recipe')">üçï –•–æ–æ–ª–Ω—ã –ñ–æ—Ä</div>
                <div class="scene-card" onclick="loadPosts('history')">üìú –¢“Ø“Ø—Ö</div>
            </div>
        </div>

        <div id="list-scene" class="scene">
            <button class="back-btn" onclick="showScene('home-scene')">‚Üê –ë—É—Ü–∞—Ö</button>
            <h1 id="category-title">–°—ç–¥—ç–≤</h1>
            <div id="posts-container" class="post-list">
                </div>
        </div>
    </div>

    <script>
        const scriptURL = "https://script.google.com/macros/s/AKfycbyjWKG3JGL0Lxqm6jCuqUI2Du6SESUKLvXMamjRZ023xh-9iBH-5TWQKROMVlJau9Jp2Q/exec";

        function showScene(id) {
            document.querySelectorAll('.scene').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            window.scrollTo(0,0);
        }

        async function loadPosts(category) {
            showScene('list-scene');
            document.getElementById('category-title').innerText = category.toUpperCase();
            const container = document.getElementById('posts-container');
            container.innerHTML = "<p class='loading'>–£–Ω—à–∏–∂ –±–∞–π–Ω–∞...</p>";

            try {
                const response = await fetch(scriptURL);
                const data = await response.json();
                
                container.innerHTML = "";
                // –°—ç–¥–≤—ç—ç—Ä –Ω—å —à“Ø“Ø–∂, —Ö–∞–º–≥–∏–π–Ω —Å“Ø“Ø–ª–∏–π–Ω—Ö –Ω—å –¥—ç—ç—Ä—ç—ç —Ö–∞—Ä–∞–≥–¥–∞—Ö–∞–∞—Ä (reverse) —Ö–∞—Ä—É—É–ª–Ω–∞
                const filtered = data.filter(row => row[0] === category).reverse();

                if (filtered.length === 0) {
                    container.innerHTML = "<p>–û–¥–æ–æ–≥–æ–æ—Ä –Ω–∏–π—Ç–ª—ç–ª –∞–ª–≥–∞.</p>";
                    return;
                }

                filtered.forEach(row => {
                    container.innerHTML += `
                        <div class="post-item">
                            <p class="post-text">${row[1]}</p>
                            ${row[2] ? `<img src="${row[2]}" class="post-img">` : ""}
                            <div class="post-date">–ù–∏–π—Ç–ª—ç–≥–¥—Å—ç–Ω</div>
                        </div>`;
                });
            } catch (e) {
                container.innerHTML = "<p>–ú—ç–¥—ç—ç–ª—ç–ª –∞–≤–∞—Ö–∞–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞. Sheet-—ç—ç —à–∞–ª–≥–∞–Ω–∞ —É—É.</p>";
            }
        }
    </script>
</body>
</html>